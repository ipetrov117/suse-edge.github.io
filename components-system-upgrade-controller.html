<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SUSE Edge Documentation | System Upgrade Controller</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="System Upgrade Controller"/>
<meta name="description" content="See the System Upgrade Controller documentation."/>
<meta name="book-title" content="SUSE Edge Documentation"/>
<meta name="chapter-title" content="Chapter 19. System Upgrade Controller"/>
<meta name="tracker-url" content="https://github.com/suse-edge/suse-edge.github.io/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="System Upgrade Controller"/>
<meta property="og:description" content="See the System Upgrade Controller documentation."/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="System Upgrade Controller"/>
<meta name="twitter:description" content="See the System Upgrade Controller documentation."/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    

    "headline": "System Upgrade Controller",
  
    "description": "System Upgrade Controller",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="components-kubevirt.html" title="Chapter 18. Edge Virtualization"/><link rel="next" href="components-upgrade-controller.html" title="Chapter 20. Upgrade Controller"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SUSE Edge Documentation</a><span> / </span><a class="crumb" href="id-components-used.html">Components Used</a><span> / </span><a class="crumb" href="components-system-upgrade-controller.html">System Upgrade Controller</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SUSE Edge Documentation</div><ol><li><a href="id-suse-edge-documentation.html" class=" "><span class="title-number"> </span><span class="title-name">SUSE Edge Documentation</span></a></li><li><a href="id-quick-starts.html" class="has-children "><span class="title-number">I </span><span class="title-name">Quick Starts</span></a><ol><li><a href="quickstart-metal3.html" class=" "><span class="title-number">1 </span><span class="title-name">BMC automated deployments with Metal<sup>3</sup></span></a></li><li><a href="quickstart-elemental.html" class=" "><span class="title-number">2 </span><span class="title-name">Remote host onboarding with Elemental</span></a></li><li><a href="quickstart-eib.html" class=" "><span class="title-number">3 </span><span class="title-name">Standalone clusters with Edge Image Builder</span></a></li></ol></li><li class="active"><a href="id-components-used.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Components Used</span></a><ol><li><a href="components-rancher.html" class=" "><span class="title-number">4 </span><span class="title-name">Rancher</span></a></li><li><a href="components-rancher-dashboard-extensions.html" class=" "><span class="title-number">5 </span><span class="title-name">Rancher Dashboard Extensions</span></a></li><li><a href="components-fleet.html" class=" "><span class="title-number">6 </span><span class="title-name">Fleet</span></a></li><li><a href="components-slmicro.html" class=" "><span class="title-number">7 </span><span class="title-name">SLE Micro</span></a></li><li><a href="components-metal3.html" class=" "><span class="title-number">8 </span><span class="title-name">Metal<sup>3</sup></span></a></li><li><a href="components-eib.html" class=" "><span class="title-number">9 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="components-nmc.html" class=" "><span class="title-number">10 </span><span class="title-name">Edge Networking</span></a></li><li><a href="components-elemental.html" class=" "><span class="title-number">11 </span><span class="title-name">Elemental</span></a></li><li><a href="components-akri.html" class=" "><span class="title-number">12 </span><span class="title-name">Akri</span></a></li><li><a href="components-k3s.html" class=" "><span class="title-number">13 </span><span class="title-name">K3s</span></a></li><li><a href="components-rke2.html" class=" "><span class="title-number">14 </span><span class="title-name">RKE2</span></a></li><li><a href="components-longhorn.html" class=" "><span class="title-number">15 </span><span class="title-name">Longhorn</span></a></li><li><a href="components-neuvector.html" class=" "><span class="title-number">16 </span><span class="title-name">NeuVector</span></a></li><li><a href="components-metallb.html" class=" "><span class="title-number">17 </span><span class="title-name">MetalLB</span></a></li><li><a href="components-kubevirt.html" class=" "><span class="title-number">18 </span><span class="title-name">Edge Virtualization</span></a></li><li><a href="components-system-upgrade-controller.html" class=" you-are-here"><span class="title-number">19 </span><span class="title-name">System Upgrade Controller</span></a></li><li><a href="components-upgrade-controller.html" class=" "><span class="title-number">20 </span><span class="title-name">Upgrade Controller</span></a></li></ol></li><li><a href="id-how-to-guides.html" class="has-children "><span class="title-number">III </span><span class="title-name">How-To Guides</span></a><ol><li><a href="guides-metallb-k3s.html" class=" "><span class="title-number">21 </span><span class="title-name">MetalLB on K3s (using L2)</span></a></li><li><a href="guides-metallb-kubernetes.html" class=" "><span class="title-number">22 </span><span class="title-name">MetalLB in front of the Kubernetes API server</span></a></li><li><a href="id-air-gapped-deployments-with-edge-image-builder.html" class=" "><span class="title-number">23 </span><span class="title-name">Air-gapped deployments with Edge Image Builder</span></a></li></ol></li><li><a href="id-third-party-integration.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Third-Party Integration</span></a><ol><li><a href="integrations-nats.html" class=" "><span class="title-number">24 </span><span class="title-name">NATS</span></a></li><li><a href="id-nvidia-gpus-on-sle-micro.html" class=" "><span class="title-number">25 </span><span class="title-name">NVIDIA GPUs on SLE Micro</span></a></li></ol></li><li><a href="day-2-operations.html" class="has-children "><span class="title-number">V </span><span class="title-name">Day 2 Operations</span></a><ol><li><a href="day2-migration.html" class=" "><span class="title-number">26 </span><span class="title-name">Edge 3.1 migration</span></a></li><li><a href="day2-mgmt-cluster.html" class=" "><span class="title-number">27 </span><span class="title-name">Management Cluster</span></a></li><li><a href="day2-downstream-clusters.html" class=" "><span class="title-number">28 </span><span class="title-name">Downstream clusters</span></a></li></ol></li><li><a href="id-product-documentation.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Product Documentation</span></a><ol><li><a href="atip.html" class=" "><span class="title-number">29 </span><span class="title-name">SUSE Adaptive Telco Infrastructure Platform (ATIP)</span></a></li><li><a href="atip-architecture.html" class=" "><span class="title-number">30 </span><span class="title-name">Concept &amp; Architecture</span></a></li><li><a href="atip-requirements.html" class=" "><span class="title-number">31 </span><span class="title-name">Requirements &amp; Assumptions</span></a></li><li><a href="atip-management-cluster.html" class=" "><span class="title-number">32 </span><span class="title-name">Setting up the management cluster</span></a></li><li><a href="atip-features.html" class=" "><span class="title-number">33 </span><span class="title-name">Telco features configuration</span></a></li><li><a href="atip-automated-provisioning.html" class=" "><span class="title-number">34 </span><span class="title-name">Fully automated directed network provisioning</span></a></li><li><a href="atip-lifecycle.html" class=" "><span class="title-number">35 </span><span class="title-name">Lifecycle actions</span></a></li></ol></li><li><a href="id-appendix.html" class="has-children "><span class="title-number">VII </span><span class="title-name">Appendix</span></a><ol><li><a href="id-release-notes.html" class=" "><span class="title-number">36 </span><span class="title-name">Release Notes</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="components-system-upgrade-controller" data-id-title="System Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">19 </span><span class="title-name">System Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>See the <a class="link" href="https://github.com/rancher/system-upgrade-controller" target="_blank">System Upgrade Controller documentation</a>.</p><div class="blockquote"><blockquote class="blockquote"><p>The System Upgrade Controller (SUC) aims to provide a general-purpose, Kubernetes-native upgrade controller (for nodes). It introduces a new CRD, the Plan, for defining any and all of your upgrade policies/requirements. A Plan is an outstanding intent to mutate nodes in your cluster.</p></blockquote></div><section class="sect1" id="id-how-does-suse-edge-use-system-upgrade-controller" data-id-title="How does SUSE Edge use System Upgrade Controller?"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">19.1 </span><span class="title-name">How does SUSE Edge use System Upgrade Controller?</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#id-how-does-suse-edge-use-system-upgrade-controller">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p><span class="strong"><strong>SUC</strong></span> is used to assist in the various <code class="literal">Day 2</code> operations that need to be executed in order to upgrade management/downstream clusters from one Edge platform version to another. <code class="literal">Day 2</code> operations are defined in the form of <span class="strong"><strong>SUC Plans</strong></span>. Based on the these plans, SUC deploys workloads on each node that executes the respective <code class="literal">Day 2</code> operations.</p></section><section class="sect1" id="components-system-upgrade-controller-install" data-id-title="Installing the System Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">19.2 </span><span class="title-name">Installing the System Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-install">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>We recommend that you install <span class="strong"><strong>SUC</strong></span> through Fleet (<a class="xref" href="components-fleet.html" title="Chapter 6. Fleet">Chapter 6, <em>Fleet</em></a>) located in the <a class="link" href="https://github.com/suse-edge/fleet-examples" target="_blank">suse-edge/fleet-examples</a> repository.</p><div id="id-1.4.18.5.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The resources offered by the <code class="literal">suse-edge/fleet-examples</code> repository <span class="strong"><strong>must</strong></span> always be used from a valid <a class="link" href="https://github.com/suse-edge/fleet-examples/releases" target="_blank">fleet-examples release</a>. To determine which release you need to use, refer to the Release Notes (<a class="xref" href="id-release-notes.html#release-notes" title="36.1. Abstract">Section 36.1, “Abstract”</a>).</p></div><p>If you are unable to use Fleet (<a class="xref" href="components-fleet.html" title="Chapter 6. Fleet">Chapter 6, <em>Fleet</em></a>) for the installation of <span class="strong"><strong>SUC</strong></span>, you can install it through Rancher’s Helm chart repository, or incorporate the Rancher’s Helm chart in your own third-party GitOps workflow.</p><p>This section covers:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Fleet installation (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet" title="19.2.1. System Upgrade Controller Fleet installation">Section 19.2.1, “System Upgrade Controller Fleet installation”</a>)</p></li><li class="listitem"><p>Helm installation (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-helm" title="19.2.2. System Upgrade Controller Helm installation">Section 19.2.2, “System Upgrade Controller Helm installation”</a>)</p></li></ul></div><section class="sect2" id="components-system-upgrade-controller-fleet" data-id-title="System Upgrade Controller Fleet installation"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">19.2.1 </span><span class="title-name">System Upgrade Controller Fleet installation</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Using <span class="strong"><strong>Fleet</strong></span> there are two possible resources that can be used to deploy <span class="strong"><strong>SUC</strong></span>:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><a class="link" href="https://fleet.rancher.io/ref-gitrepo" target="_blank">GitRepo</a> resource - for use-cases where an external/local Git server is available. For installation instructions, see System Upgrade Controller installation - GitRepo (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-gitrepo" title="19.2.1.1. System Upgrade Controller installation - GitRepo">Section 19.2.1.1, “System Upgrade Controller installation - GitRepo”</a>).</p></li><li class="listitem"><p><a class="link" href="https://fleet.rancher.io/bundle-add" target="_blank">Bundle</a> resource - for air-gapped use-cases that do not support a local Git server option. For installation instructions, see System Upgrade Controller installation - Bundle (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-bundle" title="19.2.1.2. System Upgrade Controller installation - Bundle">Section 19.2.1.2, “System Upgrade Controller installation - Bundle”</a>).</p></li></ul></div><section class="sect3" id="components-system-upgrade-controller-fleet-gitrepo" data-id-title="System Upgrade Controller installation - GitRepo"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">19.2.1.1 </span><span class="title-name">System Upgrade Controller installation - GitRepo</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-gitrepo">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div id="id-1.4.18.5.7.4.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>This process can also be done through the Rancher UI, if such is available. For more information, see <a class="link" href="https://ranchermanager.docs.rancher.com/integrations-in-rancher/fleet/overview#accessing-fleet-in-the-rancher-ui" target="_blank">Accessing Fleet in the Rancher UI</a>.</p></div><p>In your <span class="strong"><strong>management</strong></span> cluster:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Determine on which clusters you want to deploy <span class="strong"><strong>SUC</strong></span>. This is done by deploying the <span class="strong"><strong>SUC GitRepo</strong></span> in the correct Fleet workspace inside your <span class="strong"><strong>management</strong></span> cluster. By default, Fleet has two workspaces:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">fleet-local</code> - for resources that need to be deployed on the <span class="strong"><strong>management</strong></span> cluster.</p></li><li class="listitem"><p><code class="literal">fleet-default</code> - for resources that need to be deployed on <span class="strong"><strong>downstream</strong></span> clusters.</p><p>For more information on Fleet workspaces, see the <a class="link" href="https://fleet.rancher.io/namespaces#gitrepos-bundles-clusters-clustergroups" target="_blank">upstream</a> documentation.</p></li></ul></div></li><li class="listitem"><p>Deploy the <span class="strong"><strong>GitRepo</strong></span> resource:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>To deploy <span class="strong"><strong>SUC</strong></span> on your <span class="strong"><strong>management</strong></span> cluster:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -n fleet-local -f - &lt;&lt;EOF
apiVersion: fleet.cattle.io/v1alpha1
kind: GitRepo
metadata:
  name: system-upgrade-controller
spec:
  revision: release-3.1.0
  paths:
  - fleets/day2/system-upgrade-controller
  repo: https://github.com/suse-edge/fleet-examples.git
EOF</pre></div></li><li class="listitem"><p>To deploy <span class="strong"><strong>SUC</strong></span> on your <span class="strong"><strong>downstream</strong></span> clusters:</p><div id="id-1.4.18.5.7.4.4.2.2.2.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Before deploying the resource below, you <span class="strong"><strong>must</strong></span> provide a valid <code class="literal">targets</code> configuration, so that Fleet knows on which downstream clusters to deploy your resource. For information on how to map to downstream clusters, see <a class="link" href="https://fleet.rancher.io/gitrepo-targets" target="_blank">Mapping to Downstream Clusters</a>.</p></div><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -n fleet-default -f - &lt;&lt;EOF
apiVersion: fleet.cattle.io/v1alpha1
kind: GitRepo
metadata:
  name: system-upgrade-controller
spec:
  revision: release-3.1.0
  paths:
  - fleets/day2/system-upgrade-controller
  repo: https://github.com/suse-edge/fleet-examples.git
  targets:
  - clusterSelector: CHANGEME
  # Example matching all clusters:
  # targets:
  # - clusterSelector: {}
EOF</pre></div></li></ul></div></li><li class="listitem"><p>Validate that the <span class="strong"><strong>GitRepo</strong></span> is deployed:</p><div class="verbatim-wrap highlight bash"><pre class="screen"># Namespace will vary based on where you want to deploy SUC
kubectl get gitrepo system-upgrade-controller -n &lt;fleet-local/fleet-default&gt;

NAME                        REPO                                              COMMIT          BUNDLEDEPLOYMENTS-READY   STATUS
system-upgrade-controller   https://github.com/suse-edge/fleet-examples.git   release-3.1.0   1/1</pre></div></li><li class="listitem"><p>Validate the <span class="strong"><strong>System Upgrade Controller</strong></span> deployment:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment system-upgrade-controller -n cattle-system
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
system-upgrade-controller   1/1     1            1           2m20s</pre></div></li></ol></div></section><section class="sect3" id="components-system-upgrade-controller-fleet-bundle" data-id-title="System Upgrade Controller installation - Bundle"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">19.2.1.2 </span><span class="title-name">System Upgrade Controller installation - Bundle</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-bundle">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>This section illustrates how to build and deploy a <span class="strong"><strong>Bundle</strong></span> resource from a standard Fleet configuration using the <a class="link" href="https://fleet.rancher.io/cli/fleet-cli/fleet" target="_blank">fleet-cli</a>.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>On a machine with network access download the <span class="strong"><strong>fleet-cli</strong></span>:</p><div id="id-1.4.18.5.7.5.3.1.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Make sure that the version of the <span class="strong"><strong>fleet-cli</strong></span> you download matches the version of Fleet that has been deployed on your cluster.</p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>For Mac users there is a <a class="link" href="https://formulae.brew.sh/formula/fleet-cli" target="_blank">fleet-cli</a> Homebrew Formulae.</p></li><li class="listitem"><p>For Linux and Windows users the binaries are present as <span class="strong"><strong>assets</strong></span> to each Fleet <a class="link" href="https://github.com/rancher/fleet/releases" target="_blank">release</a>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Linux AMD:</p><div class="verbatim-wrap highlight bash"><pre class="screen">curl -L -o fleet-cli https://github.com/rancher/fleet/releases/download/&lt;FLEET_VERSION&gt;/fleet-linux-amd64</pre></div></li><li class="listitem"><p>Linux ARM:</p><div class="verbatim-wrap highlight bash"><pre class="screen">curl -L -o fleet-cli https://github.com/rancher/fleet/releases/download/&lt;FLEET_VERSION&gt;/fleet-linux-arm64</pre></div></li></ul></div></li></ul></div></li><li class="listitem"><p>Make <code class="literal">fleet-cli</code> executable:</p><div class="verbatim-wrap highlight bash"><pre class="screen">chmod +x fleet-cli</pre></div></li><li class="listitem"><p>Clone the <span class="strong"><strong>suse-edge/fleet-examples</strong></span> <a class="link" href="https://github.com/suse-edge/fleet-examples/releases" target="_blank">release</a> that you wish to use:</p><div class="verbatim-wrap highlight bash"><pre class="screen">git clone -b release-3.1.0 https://github.com/suse-edge/fleet-examples.git</pre></div></li><li class="listitem"><p>Navigate to the <span class="strong"><strong>SUC</strong></span> fleet, located in the <span class="strong"><strong>fleet-examples</strong></span> repo:</p><div class="verbatim-wrap highlight bash"><pre class="screen">cd fleet-examples/fleets/day2/system-upgrade-controller</pre></div></li><li class="listitem"><p>Determine on which clusters you want to deploy <span class="strong"><strong>SUC</strong></span>. This is done by deploying the <span class="strong"><strong>SUC Bundle</strong></span> in the correct Fleet workspace inside your <span class="strong"><strong>management</strong></span> cluster. By default, Fleet has two workspaces:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">fleet-local</code> - for resources that need to be deployed on the <span class="strong"><strong>management</strong></span> cluster.</p></li><li class="listitem"><p><code class="literal">fleet-default</code> - for resources that need to be deployed on <span class="strong"><strong>downstream</strong></span> clusters.</p><p>For more information on Fleet workspaces, see the <a class="link" href="https://fleet.rancher.io/namespaces#gitrepos-bundles-clusters-clustergroups" target="_blank">upstream</a> documentation.</p></li></ul></div></li><li class="listitem"><p><span class="strong"><strong>If you intend to deploy SUC only on downstream clusters</strong></span>, create a <span class="strong"><strong>targets.yaml</strong></span> file that matches the specific clusters:</p><div class="verbatim-wrap highlight bash"><pre class="screen">cat &gt; targets.yaml &lt;&lt;EOF
targets:
- clusterSelector: CHANGEME
EOF</pre></div><p>For information on how to map to downstream clusters, see <a class="link" href="https://fleet.rancher.io/gitrepo-targets" target="_blank">Mapping to Downstream Clusters</a></p></li><li class="listitem"><p>Proceed to building the Bundle:</p><div id="id-1.4.18.5.7.5.3.7.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Make sure you did <span class="strong"><strong>not</strong></span> download the <span class="strong"><strong>fleet-cli</strong></span> in the <code class="literal">fleet-examples/fleets/day2/system-upgrade-controller</code> directory, otherwise it will be packaged with the Bundle, which is not advised.</p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>To deploy <span class="strong"><strong>SUC</strong></span> on your <span class="strong"><strong>management</strong></span> cluster, execute:</p><div class="verbatim-wrap highlight bash"><pre class="screen">fleet-cli apply --compress -n fleet-local -o - system-upgrade-controller . &gt; system-upgrade-controller-bundle.yaml</pre></div></li><li class="listitem"><p>To deploy <span class="strong"><strong>SUC</strong></span> on your <span class="strong"><strong>downstream</strong></span> clusters, execute:</p><div class="verbatim-wrap highlight bash"><pre class="screen">fleet-cli apply --compress --targets-file=targets.yaml -n fleet-default -o - system-upgrade-controller . &gt; system-upgrade-controller-bundle.yaml</pre></div><p>For more information about this process, see <a class="link" href="https://fleet.rancher.io/bundle-add#convert-a-helm-chart-into-a-bundle" target="_blank">Convert a Helm Chart into a Bundle</a>.</p><p>For more information about the <code class="literal">fleet-cli apply</code> command, see <a class="link" href="https://fleet.rancher.io/cli/fleet-cli/fleet_apply" target="_blank">fleet apply</a>.</p></li></ul></div></li><li class="listitem"><p>Transfer the <span class="strong"><strong>system-upgrade-controller-bundle.yaml</strong></span> bundle to your <span class="strong"><strong>management</strong></span> cluster machine:</p><div class="verbatim-wrap highlight bash"><pre class="screen">scp system-upgrade-controller-bundle.yaml &lt;machine-address&gt;:&lt;filesystem-path&gt;</pre></div></li><li class="listitem"><p>On your <span class="strong"><strong>management</strong></span> cluster, deploy the <span class="strong"><strong>system-upgrade-controller-bundle.yaml</strong></span> Bundle:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -f system-upgrade-controller-bundle.yaml</pre></div></li><li class="listitem"><p>On your <span class="strong"><strong>management</strong></span> cluster, validate that the <span class="strong"><strong>Bundle</strong></span> is deployed:</p><div class="verbatim-wrap highlight bash"><pre class="screen"># Namespace will vary based on where you want to deploy SUC
kubectl get bundle system-upgrade-controller -n &lt;fleet-local/fleet-default&gt;

NAME                        BUNDLEDEPLOYMENTS-READY   STATUS
system-upgrade-controller   1/1</pre></div></li><li class="listitem"><p>Based on the Fleet workspace that you deployed your <span class="strong"><strong>Bundle</strong></span> to, navigate to the cluster and validate the <span class="strong"><strong>SUC</strong></span> deployment:</p><div id="id-1.4.18.5.7.5.3.11.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p><span class="strong"><strong>SUC</strong></span> is always deployed in the <span class="strong"><strong>cattle-system</strong></span> namespace.</p></div><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment system-upgrade-controller -n cattle-system
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
system-upgrade-controller   1/1     1            1           111s</pre></div></li></ol></div></section></section><section class="sect2" id="components-system-upgrade-controller-helm" data-id-title="System Upgrade Controller Helm installation"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">19.2.2 </span><span class="title-name">System Upgrade Controller Helm installation</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-helm">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Add the Rancher chart repository:</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm repo add rancher-charts https://charts.rancher.io/</pre></div></li><li class="listitem"><p>Deploy the <span class="strong"><strong>SUC</strong></span> chart:</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm install system-upgrade-controller rancher-charts/system-upgrade-controller --version 104.0.0+up0.7.0 --set global.cattle.psp.enabled=false -n cattle-system --create-namespace</pre></div><p>This will install <span class="strong"><strong>SUC</strong></span> <code class="literal">0.13.4</code> version which is needed by the Edge 3.1 platform.</p></li><li class="listitem"><p>Validate the <span class="strong"><strong>SUC</strong></span> deployment:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment system-upgrade-controller -n cattle-system
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
system-upgrade-controller   1/1     1            1           37s</pre></div></li></ol></div></section></section><section class="sect1" id="components-system-upgrade-controller-monitor-plans" data-id-title="Monitoring System Upgrade Controller Plans"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">19.3 </span><span class="title-name">Monitoring System Upgrade Controller Plans</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p><span class="strong"><strong>SUC</strong></span> Plans can be viewed in the following ways:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Through the Rancher UI (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-rancher" title="19.3.1. Monitoring System Upgrade Controller Plans - Rancher UI">Section 19.3.1, “Monitoring System Upgrade Controller Plans - Rancher UI”</a>).</p></li><li class="listitem"><p>Through manual monitoring (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-manual" title="19.3.2. Monitoring System Upgrade Controller Plans - Manual">Section 19.3.2, “Monitoring System Upgrade Controller Plans - Manual”</a>) inside of the cluster.</p></li></ul></div><div id="id-1.4.18.6.4" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>Pods deployed for <span class="strong"><strong>SUC Plans</strong></span> are kept alive <span class="strong"><strong>15</strong></span> minutes after a successful execution. After that they are removed by the corresponding Job that created them. To have access to the Pod’s logs after this time period, you should enable logging for your cluster. For information on how to do this in Rancher, see <a class="link" href="https://ranchermanager.docs.rancher.com/v2.9/integrations-in-rancher/logging" target="_blank">Rancher Integration with Logging Services</a>.</p></div><section class="sect2" id="components-system-upgrade-controller-monitor-plans-rancher" data-id-title="Monitoring System Upgrade Controller Plans - Rancher UI"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">19.3.1 </span><span class="title-name">Monitoring System Upgrade Controller Plans - Rancher UI</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-rancher">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To check <span class="strong"><strong>Pod</strong></span> logs for the specific <span class="strong"><strong>SUC</strong></span> plan:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In the upper left corner, <span class="strong"><strong>☰ → &lt;your-cluster-name&gt;</strong></span></p></li><li class="listitem"><p>Select <span class="strong"><strong>Workloads → Pods</strong></span></p></li><li class="listitem"><p>Select the <code class="literal">Only User Namespaces</code> drop down menu and add the <code class="literal">cattle-system</code> namespace</p></li><li class="listitem"><p>In the Pod filter bar, write the name for your <span class="strong"><strong>SUC Plan</strong></span> Pod. The name will be in the following template format: <code class="literal">apply-&lt;plan_name&gt;-on-&lt;node_name&gt;</code></p><div id="id-1.4.18.6.5.3.4.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>There may be both <span class="strong"><strong>Completed</strong></span> and <span class="strong"><strong>Unknown</strong></span> Pods for a specific SUC Plan. This is expected and happens due to the nature of some of the upgrades.</p></div></li><li class="listitem"><p>Select the pod that you want to review the logs of and navigate to <span class="strong"><strong>⋮ → View Logs</strong></span></p></li></ol></div></section><section class="sect2" id="components-system-upgrade-controller-monitor-plans-manual" data-id-title="Monitoring System Upgrade Controller Plans - Manual"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">19.3.2 </span><span class="title-name">Monitoring System Upgrade Controller Plans - Manual</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-manual">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div id="id-1.4.18.6.6.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The below steps assume that <code class="literal">kubectl</code> has been configured to connect to the cluster where the <span class="strong"><strong>SUC Plans</strong></span> have been deployed to.</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>List deployed <span class="strong"><strong>SUC</strong></span> Plans:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get plans -n cattle-system</pre></div></li><li class="listitem"><p>Get Pod for <span class="strong"><strong>SUC</strong></span> Plan:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get pods -l upgrade.cattle.io/plan=&lt;plan_name&gt; -n cattle-system</pre></div><div id="id-1.4.18.6.6.3.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>There may be both <span class="strong"><strong>Completed</strong></span> and <span class="strong"><strong>Unknown</strong></span> Pods for a specific SUC Plan. This is expected and happens due to the nature of some of the upgrades.</p></div></li><li class="listitem"><p>Get logs for the Pod:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl logs &lt;pod_name&gt; -n cattle-system</pre></div></li></ol></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="components-kubevirt.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 18 </span>Edge Virtualization</span></a> </div><div><a class="pagination-link next" href="components-upgrade-controller.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 20 </span>Upgrade Controller</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="components-system-upgrade-controller.html#id-how-does-suse-edge-use-system-upgrade-controller"><span class="title-number">19.1 </span><span class="title-name">How does SUSE Edge use System Upgrade Controller?</span></a></span></li><li><span class="section"><a href="components-system-upgrade-controller.html#components-system-upgrade-controller-install"><span class="title-number">19.2 </span><span class="title-name">Installing the System Upgrade Controller</span></a></span></li><li><span class="section"><a href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans"><span class="title-number">19.3 </span><span class="title-name">Monitoring System Upgrade Controller Plans</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>