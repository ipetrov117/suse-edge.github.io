<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SUSE Edge Documentation | Remote host onboarding with Elemental</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Remote host onboarding with Elemental"/>
<meta name="description" content="Elemental is a software stack that provides for remote control over the lifecycles of the Operating System, Kubernetes, and workload in a secure and …"/>
<meta name="book-title" content="SUSE Edge Documentation"/>
<meta name="chapter-title" content="Chapter 3. Remote host onboarding with Elemental"/>
<meta name="tracker-url" content="https://github.com/suse-edge/suse-edge.github.io/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Remote host onboarding with Elemental"/>
<meta property="og:description" content="Elemental is a software stack that provides for remote cont…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Remote host onboarding with Elemental"/>
<meta name="twitter:description" content="Elemental is a software stack that provides for remote cont…"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
    "inLanguage": "en",
    

    "headline": "Remote host onboarding with Elemental",
  
    "description": "Remote host onboarding with Elemental",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-04-02T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="id-bmc-automated-deployments-with-metal3.html" title="Chapter 2. BMC automated deployments with Metal3"/><link rel="next" href="id-components-used-2.html" title="Part II. Components Used"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SUSE Edge Documentation</a><span> / </span><a class="crumb" href="id-quickstarts.html">Quickstarts</a><span> / </span><a class="crumb" href="quickstart-elemental.html">Remote host onboarding with Elemental</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SUSE Edge Documentation</div><ol><li><a href="id-suse-edge-documentation.html" class=" "><span class="title-number"> </span><span class="title-name">SUSE Edge Documentation</span></a></li><li class="active"><a href="id-quickstarts.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">Quickstarts</span></a><ol><li><a href="quickstart-eib.html" class=" "><span class="title-number">1 </span><span class="title-name">Standalone Clusters with Edge Image Builder</span></a></li><li><a href="id-bmc-automated-deployments-with-metal3.html" class=" "><span class="title-number">2 </span><span class="title-name">BMC automated deployments with Metal<sup>3</sup></span></a></li><li><a href="quickstart-elemental.html" class=" you-are-here"><span class="title-number">3 </span><span class="title-name">Remote host onboarding with Elemental</span></a></li></ol></li><li><a href="id-components-used-2.html" class="has-children "><span class="title-number">II </span><span class="title-name">Components Used</span></a><ol><li><a href="components-elemental.html" class=" "><span class="title-number">4 </span><span class="title-name">Elemental</span></a></li><li><a href="components-fleet.html" class=" "><span class="title-number">5 </span><span class="title-name">Fleet</span></a></li><li><a href="components-longhorn.html" class=" "><span class="title-number">6 </span><span class="title-name">Longhorn</span></a></li><li><a href="components-metal3.html" class=" "><span class="title-number">7 </span><span class="title-name">Metal³</span></a></li><li><a href="components-metallb.html" class=" "><span class="title-number">8 </span><span class="title-name">MetalLB</span></a></li><li><a href="components-neuvector.html" class=" "><span class="title-number">9 </span><span class="title-name">NeuVector</span></a></li><li><a href="components-rancher.html" class=" "><span class="title-number">10 </span><span class="title-name">Rancher</span></a></li><li><a href="components-slmicro.html" class=" "><span class="title-number">11 </span><span class="title-name">SLE Micro</span></a></li><li><a href="components-k3s.html" class=" "><span class="title-number">12 </span><span class="title-name">K3s</span></a></li><li><a href="components-rke2.html" class=" "><span class="title-number">13 </span><span class="title-name">RKE2</span></a></li><li><a href="components-eib.html" class=" "><span class="title-number">14 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="id-edge-virtualization.html" class=" "><span class="title-number">15 </span><span class="title-name">Edge Virtualization</span></a></li></ol></li><li><a href="id-how-to-guides.html" class="has-children "><span class="title-number">III </span><span class="title-name">How To Guides</span></a><ol><li><a href="guides-metallb-k3s.html" class=" "><span class="title-number">16 </span><span class="title-name">MetalLB on K3s (using L2)</span></a></li><li><a href="guides-metallb-kubernetes.html" class=" "><span class="title-number">17 </span><span class="title-name">MetalLB in front of the Kubernetes API server</span></a></li></ol></li><li><a href="id-third-party-integration.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Third Party Integration</span></a><ol><li><a href="integrations-linkert.html" class=" "><span class="title-number">18 </span><span class="title-name">Using the Linkerd Service Mesh</span></a></li><li><a href="integrations-nats.html" class=" "><span class="title-number">19 </span><span class="title-name">NATS</span></a></li><li><a href="id-nvidia-gpus-on-sle-micro.html" class=" "><span class="title-number">20 </span><span class="title-name">NVIDIA GPU’s on SLE Micro</span></a></li></ol></li><li><a href="id-product-documentation.html" class="has-children "><span class="title-number">V </span><span class="title-name">Product Documentation</span></a><ol><li><a href="atip.html" class=" "><span class="title-number">21 </span><span class="title-name">SUSE Adaptive Telco Infrastructure Platform (ATIP)</span></a></li></ol></li><li><a href="id-appendix.html" class="has-children "><span class="title-number">A </span><span class="title-name">Appendix</span></a><ol><li><a href="id-appendix.html#id-terminology" class=" "><span class="title-number"> </span><span class="title-name">Terminology</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="quickstart-elemental" data-id-title="Remote host onboarding with Elemental"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">3 </span><span class="title-name">Remote host onboarding with Elemental</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Elemental is a software stack that provides for remote control over the lifecycles of the Operating System, Kubernetes, and workload in a secure and declarative way.</p><section class="sect1" id="id-why-use-this-method-2" data-id-title="Why use this method"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.1 </span><span class="title-name">Why use this method</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-why-use-this-method-2">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Elemental can be very useful for scenarios where the devices that you want to control are not on the same network as the upstream cluster or don’t have a BMC onboard to allow more direct control.</p><p>TODO: expand</p></section><section class="sect1" id="id-high-level-architecture-2" data-id-title="High Level Architecture"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.2 </span><span class="title-name">High Level Architecture</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-high-level-architecture-2">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>TODO: Draw image</p></section><section class="sect1" id="id-resources-needed" data-id-title="Resources Needed"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.3 </span><span class="title-name">Resources Needed</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-resources-needed">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>At the very least, you need:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>A host for the "upstream" cluster (the one hosting Rancher and Elemental) with:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Minimum 8GB RAM and 20GB disk space for development or testing</p></li><li class="listitem"><p>For production use: See <a class="link" href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/installation-requirements#hardware-requirements" target="_blank">https://ranchermanager.docs.rancher.com/pages-for-subheaders/installation-requirements#hardware-requirements</a></p></li></ul></div></li><li class="listitem"><p>A host to be controlled</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Could be physical device or Virtual Machine</p></li><li class="listitem"><p>Minimum 25GB disk</p></li></ul></div></li><li class="listitem"><p>A resolvable hostname</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Or static ip address to use with a service like sslip.io</p></li></ul></div></li><li class="listitem"><p>A host to build the installation media with</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>This would likely be your local computer for most people</p></li><li class="listitem"><p><a class="link" href="https://kubernetes.io/docs/reference/kubectl/kubectl/" target="_blank">Kubectl</a>, <a class="link" href="https://podman.io" target="_blank">Podman</a>, and <a class="link" href="https://helm.sh" target="_blank">Helm</a> need to be installed</p></li><li class="listitem"><p>TODO: edit this after writing the EIB doc</p></li></ul></div></li><li class="listitem"><p>(If using physical hardware) A USB flash drive to boot from</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Existing will be overwritten as part of the process</p></li></ul></div></li></ul></div><p>In the writing of this guide, I will be using a Digital Ocean droplet to host the upstream cluster and an Intel NUC as the downstream device. For building the installation media, I will be using my desktop running <a class="link" href="https://get.opensuse.org/tumbleweed/" target="_blank">openSUSE Tumbleweed</a>.</p></section><section class="sect1" id="id-how-to-use-elemental" data-id-title="How to Use Elemental"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.4 </span><span class="title-name">How to Use Elemental</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-how-to-use-elemental">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The basic steps to install and use Elemental are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Build bootstrap cluster</p></li><li class="listitem"><p>Install Rancher</p></li><li class="listitem"><p>Install Elemental Operator and Rancher UI Extension</p></li><li class="listitem"><p>Build installer disk</p></li><li class="listitem"><p>Boot device with installer</p></li><li class="listitem"><p>Create downstream cluster</p></li></ul></div><p>TODO: Record video and embed</p><section class="sect2" id="id-build-bootstrap-cluster" data-id-title="Build Bootstrap Cluster"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.4.1 </span><span class="title-name">Build Bootstrap Cluster</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-build-bootstrap-cluster">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The first thing we need to do is create a cluster that can host Rancher and Elemental. This cluster needs to be routable from the network that the downstream nodes are connected to.</p><p>TODO: make prose</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Create Kubernetes Cluster</p></li><li class="listitem"><p>Install Rancher</p></li><li class="listitem"><p>Install Elemental</p></li><li class="listitem"><p>(Optionally) Install Elemental UI Extension</p></li></ul></div><section class="sect3" id="id-create-kubernetes-cluster" data-id-title="Create Kubernetes Cluster"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.4.1.1 </span><span class="title-name">Create Kubernetes Cluster</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-create-kubernetes-cluster">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>If you are using a hyperscaler (such as Azure, AWS, or Google Cloud), it’s likely easiest to set up a cluster using their built in tooling. For the sake of conciseness in this guide, we will not be detailing the process of each of these options.</p><p>If you are installing onto bare metal or another hosting service where you need to also provide the Kubernetes distribution itself, we recommend using <a class="link" href="https://docs.rke2.io/install/quickstart" target="_blank">RKE2</a>.</p><p>TODO: Should I add more detail?</p></section><section class="sect3" id="id-setup-dns" data-id-title="Setup DNS"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.4.1.2 </span><span class="title-name">Setup DNS</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-setup-dns">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Before continuing, you will need to setup access to your cluster. As with the setup of the cluster itself, how you configure DNS will be different depending on where it’s being hosted.</p><div id="id-1.3.5.6.5.6.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>If you don’t want to deal with setting up DNS records (for example this is just an ephemeral test server), you can use a service like <a class="link" href="https://sslip.io" target="_blank">sslip.io</a> instead. With this service, you can resolve any ip address with <code class="literal">&lt;address&gt;.sslip.io</code>.</p></div></section><section class="sect3" id="id-install-rancher" data-id-title="Install Rancher"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.4.1.3 </span><span class="title-name">Install Rancher</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-install-rancher">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To install Rancher, you need to get access to the kubeapi of the cluster you just created. This looks differently depending on what distribution of Kubernetes is being used.</p><p>For RKE2,the kubeconfig file will have been written to <code class="literal">/etc/rancher/rke2/rke2.yaml</code>. Save this file to <code class="literal">~/.kube/config</code> on your local system. You may need to edit the file to include the correct externally routable IP address or hostname.</p><p>The simplest way to get Rancher installed is with these commands that can be found in the <a class="link" href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/install-upgrade-on-a-kubernetes-cluster" target="_blank">Rancher Documentation</a>:</p><p>TODO: simplify these a bit
TODO: Do I need to explicitly allow for "local" management in the helm install?</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Install <a class="link" href="https://cert-manager.io" target="_blank">cert-manager</a>:</p><div class="variablelist"><dl class="variablelist tabs"><dt id="id-1.3.5.6.5.7.6.1.2.1"><span class="term">Linux</span></dt><dd><div class="verbatim-wrap highlight bash"><pre class="screen">helm repo add rancher-latest https://releases.rancher.com/server-charts/latest
kubectl create namespace cattle-system
kubectl apply -f \
 https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml
helm repo add jetstack https://charts.jetstack.io
helm repo update
helm install cert-manager jetstack/cert-manager \
 --namespace cert-manager \
 --create-namespace</pre></div></dd><dt id="id-1.3.5.6.5.7.6.1.2.2"><span class="term">MacOS</span></dt><dd><div class="verbatim-wrap highlight bash"><pre class="screen">helm repo add rancher-latest https://releases.rancher.com/server-charts/latest
kubectl create namespace cattle-system
kubectl apply -f \
 https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml
helm repo add jetstack https://charts.jetstack.io
helm repo update
helm install cert-manager jetstack/cert-manager \
 --namespace cert-manager \
 --create-namespace</pre></div></dd><dt id="id-1.3.5.6.5.7.6.1.2.3"><span class="term">Windows</span></dt><dd><div class="verbatim-wrap highlight bash"><pre class="screen">helm repo add rancher-latest https://releases.rancher.com/server-charts/latest
kubectl create namespace cattle-system
kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml
helm repo add jetstack https://charts.jetstack.io
helm repo update
helm install cert-manager jetstack/cert-manager `
  --namespace cert-manager `
  --create-namespace</pre></div></dd></dl></div></li><li class="listitem"><p>Then install Rancher itself:</p><div class="variablelist"><dl class="variablelist tabs"><dt id="id-1.3.5.6.5.7.6.2.2.1"><span class="term">Linux</span></dt><dd><div class="verbatim-wrap highlight bash"><pre class="screen">helm install rancher rancher-latest/rancher \
  --namespace cattle-system \
  --set hostname=&lt;DNS or sslip from above&gt; \
  --set replicas=1 \
  --set bootstrapPassword=&lt;PASSWORD_FOR_RANCHER_ADMIN&gt;</pre></div></dd><dt id="id-1.3.5.6.5.7.6.2.2.2"><span class="term">MacOS</span></dt><dd><div class="verbatim-wrap highlight bash"><pre class="screen">helm install rancher rancher-latest/rancher \
  --namespace cattle-system \
  --set hostname=&lt;DNS or sslip from above&gt; \
  --set replicas=1 \
  --set bootstrapPassword=&lt;PASSWORD_FOR_RANCHER_ADMIN&gt;</pre></div></dd><dt id="id-1.3.5.6.5.7.6.2.2.3"><span class="term">Windows</span></dt><dd><div class="verbatim-wrap highlight bash"><pre class="screen">helm install rancher rancher-latest/rancher `
  --namespace cattle-system `
  --set hostname=&lt;DNS or sslip from above&gt; `
  --set replicas=1 `
  --set bootstrapPassword=&lt;PASSWORD_FOR_RANCHER_ADMIN&gt;</pre></div></dd></dl></div></li></ol></div><div id="id-1.3.5.6.5.7.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>If this is intended to be a production system, please use cert-manager to configure a real certificate (such as one from Let’s Encrypt).</p></div><p>Browse to the hostname you set up and log in to Rancher with the bootstrapPassword you used. There is a short setup process that you will be guided through.</p></section><section class="sect3" id="id-install-elemental" data-id-title="Install Elemental"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.4.1.4 </span><span class="title-name">Install Elemental</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-install-elemental">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>With Rancher installed, you can now install Elemental itself!</p><p>The helm chart for Elemental is published as an OCI artifact so the installation is a little simpler than other charts. It can be installed from either the same shell you used to install Rancher or in the browser from within Rancher’s shell.</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm install --create-namespace -n cattle-elemental-system \
 elemental-operator-crds \
 oci://registry.suse.com/rancher/elemental-operator-crds-chart
helm install --create-namespace -n cattle-elemental-system \
 elemental-operator \
 oci://registry.suse.com/rancher/elemental-operator-chart</pre></div></section><section class="sect3" id="id-optionally-install-the-elemental-ui-extension" data-id-title="(Optionally) Install the Elemental UI Extension"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.4.1.5 </span><span class="title-name">(Optionally) Install the Elemental UI Extension</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-optionally-install-the-elemental-ui-extension">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>If you want to use the Elemental UI, you can go log in to your Rancher instance, click on the "hamburger menu" in the top left, then</p><div class="informalfigure"><div class="mediaobject"><a href="images/installing-elemental-extension-1.png"><img src="images/installing-elemental-extension-1.png" width="NaN" alt="Installing Elemental Extension1" title="Installing Elemental Extension1"/></a></div></div></li><li class="listitem"><p>From the "Available" tab on this page, you can then click "Install" on the Elemental card:</p><div class="informalfigure"><div class="mediaobject"><a href="images/installing-elemental-extension-2.png"><img src="images/installing-elemental-extension-2.png" width="NaN" alt="Installing Elemental Extension 2" title="Installing Elemental Extension 2"/></a></div></div></li><li class="listitem"><p>Confirm that you want to install the extension:</p><div class="informalfigure"><div class="mediaobject"><a href="images/installing-elemental-extension-3.png"><img src="images/installing-elemental-extension-3.png" width="NaN" alt="Installing Elemental Extension 3" title="Installing Elemental Extension 3"/></a></div></div></li><li class="listitem"><p>After this installs, you will be prompted to reload the page.</p><div class="informalfigure"><div class="mediaobject"><a href="images/installing-elemental-extension-4.png"><img src="images/installing-elemental-extension-4.png" width="NaN" alt="Installing Elemental Extension 4" title="Installing Elemental Extension 4"/></a></div></div></li><li class="listitem"><p>Once you reload, you can access the Elemental Extension through the "OS Management" global app.</p><div class="informalfigure"><div class="mediaobject"><a href="images/accessing-elemental-extension.png"><img src="images/accessing-elemental-extension.png" width="NaN" alt="Accessing Elemental Extension" title="Accessing Elemental Extension"/></a></div></div></li></ol></div><p>TODO: annotate screenshots</p><p>TODO: retake screenshots with Rancher 2.8.2 and Elemental 1.4 once released</p></section><section class="sect3" id="id-configure-elemental" data-id-title="Configure Elemental"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.4.1.6 </span><span class="title-name">Configure Elemental</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-configure-elemental">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To allow machines to register to Elemental, we need to create a MachineRegistration object in the <code class="literal">fleet-default</code> namespace.</p><p>A fairly basic version of this object is:</p><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: elemental.cattle.io/v1beta1
kind: MachineRegistration
metadata:
  name: ele-quickstart-nodes
  namespace: fleet-default
spec:
  machineName: "${System Information/Manufacturer}-${System Information/Serial Number}"
  machineInventoryLabels:
    manufacturer: "${System Information/Manufacturer}"
    productName: "${System Information/Product Name}"</pre></div><p>We can create this object in a few ways:</p><div class="variablelist"><dl class="variablelist tabs"><dt id="id-1.3.5.6.5.10.6.1"><span class="term">YAML</span></dt><dd><p>Create a file with the yaml from above called <code class="literal">registration.yaml</code> the apply it with:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -f registration.yaml</pre></div></dd><dt id="id-1.3.5.6.5.10.6.2"><span class="term">UI Extension</span></dt><dd><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>From the OS Management Extension, click "Create Registration Endpoint":</p><div class="informalfigure"><div class="mediaobject"><a href="images/click-create-registration.png"><img src="images/click-create-registration.png" width="NaN" alt="Click Create Registration" title="Click Create Registration"/></a></div></div></li><li class="listitem"><p>Give this configuration a name</p><div class="informalfigure"><div class="mediaobject"><a href="images/create-registration-name.png"><img src="images/create-registration-name.png" width="NaN" alt="Add Name" title="Add Name"/></a></div></div><div id="id-1.3.5.6.5.10.6.2.2.1.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>You can ignore the Cloud Configuration field as the data here is overridden by the following steps with Edge Image Builder</p></div></li><li class="listitem"><p>Next you can scroll down a bit and click "Add Label" for each label you want to be on the resource that gets created when a machine registers. This is useful for tracking which machine is which.</p><div class="informalfigure"><div class="mediaobject"><a href="images/create-registration-labels.png"><img src="images/create-registration-labels.png" width="NaN" alt="Add Labels" title="Add Labels"/></a></div></div></li><li class="listitem"><p>Lastly, click "Create" to save the configuration!</p><div class="informalfigure"><div class="mediaobject"><a href="images/create-registration-create.png"><img src="images/create-registration-create.png" width="NaN" alt="Click Create" title="Click Create"/></a></div></div></li></ol></div></dd></dl></div><p>Afterwards, find and note the endpoint that gets assigned:</p><div class="variablelist"><dl class="variablelist tabs"><dt id="id-1.3.5.6.5.10.8.1"><span class="term">YAML</span></dt><dd><div class="verbatim-wrap"><pre class="screen">kubectl get machineregistration ele-quickstart-nodes -n fleet-default \
 -o jsonpath '{.status.registrationURL}'</pre></div></dd><dt id="id-1.3.5.6.5.10.8.2"><span class="term">UI Extension</span></dt><dd><p>If you just created the configuration, you should see the Registration URL listed and can click "Copy" to copy the address:</p><div class="informalfigure"><div class="mediaobject"><a href="images/get-registration-url.png"><img src="images/get-registration-url.png" width="NaN" alt="Copy URL" title="Copy URL"/></a></div></div><div id="id-1.3.5.6.5.10.8.2.2.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>If you clicked away from that screen you can click on "Registration Endpoints" in the left menu then click the name of the endpoint you just created.</p></div></dd></dl></div><p>This URL will be used in the next step.</p></section></section><section class="sect2" id="id-build-installation-media" data-id-title="Build installation media"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.4.2 </span><span class="title-name">Build installation media</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-build-installation-media">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>While the current version of Elemental (at time of writing) does have a way to build it’s own installation media, we need to do this with the Edge Image Builder instead so the resulting system is built with <a class="link" href="https://www.suse.com/products/micro/" target="_blank">SLE Micro</a> as the base Operating System.</p><div id="id-1.3.5.6.6.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>For more details on the Edge Image Builder, you can check out the Getting Started Guide for it (<a class="xref" href="quickstart-eib.html" title="Chapter 1. Standalone Clusters with Edge Image Builder">Chapter 1, <em>Standalone Clusters with Edge Image Builder</em></a>). Or, for a more full discussion on it’s capabilities there is a [full page documenting it].</p></div><p>From a linux system with Podman installed, run</p><div class="verbatim-wrap highlight bash"><pre class="screen">mkdir -p eib_quickstart/base-images
mkdir -p eib_quickstart/elemental</pre></div><div class="verbatim-wrap highlight bash"><pre class="screen">curl &lt;REGISTRATION URL FROM ABOVE&gt; -o eib_quickstart/elemental/elemental.yaml</pre></div><div class="verbatim-wrap highlight yaml"><pre class="screen">echo &gt; eib_quickstart/eib-config.yaml &lt;&lt;&lt; HEREDOC
apiVersion: 1.0
image:
    imageType: iso
    arch: x86_64
    baseImage: SLE-Micro.x86_64-5.5.0-Default-SelfInstall-GM.install.iso
    outputImageName: elemental-image.iso
HEREDOC</pre></div><div class="verbatim-wrap highlight bash"><pre class="screen">podman run --privileged --rm -it -v $PWD/eib_quickstart/:/eib \
 registry.opensuse.org/home/atgracey/eib/container/containerfile/eib:latest \
 build --definition-file eib-config.yaml</pre></div><p>TODO: update image to released image on release</p><p>If you are booting a physical device, we need to burn the image to a USB flash drive. This can be done with:</p><div class="verbatim-wrap"><pre class="screen">sudo dd if=/eib_quickstart/elemental-image.iso of=/dev/&lt;PATH_TO_DISK_DEVICE&gt;</pre></div></section><section class="sect2" id="id-boot-downstream-nodes" data-id-title="Boot downstream nodes"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.4.3 </span><span class="title-name">Boot downstream nodes</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-boot-downstream-nodes">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Now that we have the installation media created, we can boot our downstream nodes with it.</p><p>For each of the systems that you want to control with Elemental, add the installation media and boot the device. After installation, it will reboot and register itself.</p><p>If you are using the UI Extension, you should see your node appear in the "Inventory of Machines".</p></section><section class="sect2" id="id-create-downstream-clusters-2" data-id-title="Create downstream clusters"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.4.4 </span><span class="title-name">Create downstream clusters</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-create-downstream-clusters-2">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>There are two objects that we need to create when provisioning a new cluster using Elemental.</p><div class="variablelist"><dl class="variablelist tabs"><dt id="id-1.3.5.6.8.3.1"><span class="term">Linux</span></dt><dd><p>The first is the MachineInventorySelectorTemplate. This object allows us to specify a mapping between Clusters and the machines in inventory.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a file called <code class="literal">selector.yaml</code> with the contents:</p><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: elemental.cattle.io/v1beta1
kind: MachineInventorySelectorTemplate
metadata:
  name: location-123-selector
  namespace: fleet-default
spec:
  template:
    spec:
      selector:
        matchLabel:
          locationID: 123</pre></div></li><li class="listitem"><p>Then we can create it with</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl create -f selector.yaml</pre></div></li><li class="listitem"><p>This will match any machine in the inventory with the label <code class="literal">locationID: 123</code> so we need to add this label to the machines that should be matched. We can do this with:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl label MachineInventory -n fleet-default \
 &lt;name of MachineInventory object&gt; locationID=123</pre></div></li><li class="listitem"><p>Next, we create the cluster itself. There are a lot of options here but a simple single-node K3s Cluster looks like:</p><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: provisioning.cattle.io/v1
kind: Cluster
metadata:
  name: location-123
  namespace: fleet-default
spec:
  kubernetesVersion: v1.26.11+k3s2
  rkeConfig:
    machinePools:
      - name: pool1
        etcdRole: true
        controlPlaneRole: true
        workerRole: true
        machineConfigRef:
          kind: MachineInventorySelectorTemplate
          name: location-123-selector
          apiVersion: elemental.cattle.io/v1beta1
          quantity: 1</pre></div></li><li class="listitem"><p>To provision this cluster, we can create a file with these contents called <code class="literal">cluster.yaml</code> and run</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl create -f cluster.yaml</pre></div></li></ol></div></dd><dt id="id-1.3.5.6.8.3.2"><span class="term">UI Extension</span></dt><dd><p>The UI extension allows for a few shortcuts to be taken. (But is likely to much manual work when managing a large number of locations)</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>As before, open the left "hamburger menu" and select "OS Management". This will bring you back to the main screen for managing you Elemental systems.</p></li><li class="listitem"><p>On the left sidebar, click "Inventory of Machines". This, unsurprisingly, opens the inventory of machines that have registered.</p></li><li class="listitem"><p>To create a cluster from these machines select the system(s) you want to you, click the "Actions" dropdown, then "Create Elemental Cluster". This will open up the Cluster Creation dialog while also creating a MachineSelectorTemplate to use in the background.</p></li><li class="listitem"><p>On this screen, you can configure the cluster you want to be built. For this quickstart, I will select K3s v1.26.11+k3s2 and leave the rest of the options alone.</p><p>TODO: Screenshot
TODO: update version of k3s once new Rancher version is stable</p><div id="id-1.3.5.6.8.3.2.2.2.4.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>You may need to scroll down to see more options</p></div></li></ol></div></dd></dl></div><p>TODO: Screenshots</p><p>After creating these objects, you should see a new kubernetes cluster spin up using the new node you just installed with.</p><div id="id-1.3.5.6.8.6" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>To allow for easier grouping of systems, you could add a startup script that finds something in the environment that is known to be unique to that location.</p><p>For example, if you know that each location will have a unique subnet, you would write a script that finds the network prefix and adds a label to the corresponding MachineInventory.</p><p>This would typically be custom to your system’s design but could look like:</p><div class="verbatim-wrap highlight bash"><pre class="screen">INET=`ip addr show dev eth0 | grep "inet\ "`
elemental-register --label "network=$INET" \
 --label "network=$INET" /oem/registration</pre></div></div></section></section><section class="sect1" id="id-next-steps-2" data-id-title="Next steps"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.5 </span><span class="title-name">Next steps</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-next-steps-2">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>TODO: prose</p><p>Some recommended next steps after using this guide are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>End to end automation with Fleet (TODO: Create page and link)</p></li><li class="listitem"><p>Additional network configuration options (TODO: Link to right section in EIB)</p></li></ul></div></section><section class="sect1" id="id-planned-changes-2" data-id-title="Planned changes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.6 </span><span class="title-name">Planned changes</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-planned-changes-2">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>There are a few changes to this that are currently planned (at time of writing):</p><section class="sect2" id="id-improved-support-for-and-integration-with-sle-micro-6-x" data-id-title="Improved support for and integration with SLE Micro 6.x"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.6.1 </span><span class="title-name">Improved support for and integration with SLE Micro 6.x</span></span> <a title="Permalink" class="permalink" href="quickstart-elemental.html#id-improved-support-for-and-integration-with-sle-micro-6-x">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Image building done in the Elemental Operator</p></li><li class="listitem"><p>Both A/B and RPM based transactional updates</p></li><li class="listitem"><p>UI improvements for non-teal images</p></li></ul></div><p>These improvements are expected to be included in an upcoming release.</p></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="id-bmc-automated-deployments-with-metal3.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 2 </span>BMC automated deployments with Metal<sup>3</sup></span></a> </div><div><a class="pagination-link next" href="id-components-used-2.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part II </span>Components Used</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="quickstart-elemental.html#id-why-use-this-method-2"><span class="title-number">3.1 </span><span class="title-name">Why use this method</span></a></span></li><li><span class="section"><a href="quickstart-elemental.html#id-high-level-architecture-2"><span class="title-number">3.2 </span><span class="title-name">High Level Architecture</span></a></span></li><li><span class="section"><a href="quickstart-elemental.html#id-resources-needed"><span class="title-number">3.3 </span><span class="title-name">Resources Needed</span></a></span></li><li><span class="section"><a href="quickstart-elemental.html#id-how-to-use-elemental"><span class="title-number">3.4 </span><span class="title-name">How to Use Elemental</span></a></span></li><li><span class="section"><a href="quickstart-elemental.html#id-next-steps-2"><span class="title-number">3.5 </span><span class="title-name">Next steps</span></a></span></li><li><span class="section"><a href="quickstart-elemental.html#id-planned-changes-2"><span class="title-number">3.6 </span><span class="title-name">Planned changes</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>